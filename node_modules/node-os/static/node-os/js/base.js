var os = (function (module) {

	var socket = io.connect('/node-os/');

	var slot = function (name, request, callback) {
		var key = localStorage.getItem('__key__');
		if (typeof name !== 'string') {
			throw new Error('You must specify the slot\'s name!');
		}
		if (arguments.length === 1) {
			request = {};
			callback = function () {};
		}
		if (typeof request === 'function') {
			callback = request;
			request = {};
		}
		if (typeof callback !== 'function') {
			callback = function () {};
		}
		request.__key__ = key;
		socket.emit('slot', name, request, callback);
	};

	module.slot = slot;
	module.socket = socket;

	module.loadContent = function () {
		socket.emit('content', { __key__: localStorage.getItem('__key__') }, function (content) {
			$('body').html(content);
		});
	};

	module.loadContent();

	return module;
}({}));